{
  "hash": "04b271a6cf7ff9f8f21dad8eaf92ab32",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Joy-Bird or Bird-Division?\"\nauthor: \"JRowing\"\ndate: \"2025-04-28\"\ncategories: [Wildlife, Statistics, Birdnet, Pop Culture]\ntitle-block-banner: false\nexecute: \n  warning: false\n  message: false\n # echo: false\n \nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n---\n\n\nSo, if yo're at all sensible you'll be fed-up already with statistics from my Birdnet-Pi, but roll with me - this one is more like artwork. \n\nInspired by listening to Joy Division earlier I thought a ridgeline plot might be the best way to show some of the time of day stuff. Here's a comparison of when in the day all the different birds have been detected, coloured by the average confidence of the identification of the bird. (not so useful that one but it makes it pretty)...\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(DBI)\nlibrary(RSQLite)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(forcats)\nlibrary(lubridate)\n\n# Connect to the database\ncon <- dbConnect(RSQLite::SQLite(), \"birds.db\")\n\n# Read detections\ndetections <- dbGetQuery(con, \"SELECT * FROM detections\")\n\n# Prepare data\ndetections <- detections %>%\n  mutate(\n    DateTime = as.POSIXct(paste(Date, Time), format = \"%Y-%m-%d %H:%M:%S\"),\n    Hour = hour(DateTime) + minute(DateTime) / 60\n  )\n\n# (Optional) Top 20 species\ntop_species <- detections %>%\n  count(Com_Name, sort = TRUE) %>%\n  slice_head(n = 100) %>%\n  pull(Com_Name)\n\ndetections_filtered <- detections %>%\n  filter(Com_Name %in% top_species)\n\n# üõ†Ô∏è Calculate overall average confidence per species\nspecies_confidence <- detections_filtered %>%\n  group_by(Com_Name) %>%\n  summarise(AvgConfidence = mean(Confidence, na.rm = TRUE), .groups = \"drop\")\n\n# Join back into main data\ndetections_final <- detections_filtered %>%\n  left_join(species_confidence, by = \"Com_Name\")\n\n# --- RIDGELINE PLOT with Species-based Fill ---\nggplot(detections_final, aes(x = Hour, y = fct_rev(factor(Com_Name)), fill = AvgConfidence)) +\n  geom_density_ridges(scale = 3, rel_min_height = 0.12, color = \"white\") +\n  scale_fill_viridis_c(name = \"Avg % Confidence\", option = \"plasma\") +\n  theme_minimal() +\n  labs(\n    title = \"Bird Detection Patterns by Time of Day\",\n    subtitle = \"Ridge Fill = Overall Average Detection Confidence\",\n    x = \"Hour of Day\",\n    y = \"Species\"\n  ) +\n  theme(\n    axis.text.y = element_text(size = 4),\n    plot.title = element_text(size = 16, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](morebirdnetstats_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nTo those of us of a certain age or musical persuassion there's more than gentle echos of the cover of Joy Division‚Äôs Unknown Pleasures (1979). That image, one of the most iconic album artworks ever, is much more minimalist, stark and mysterious.\n\nInterestingly the cover is a plot of successive radio pulses from the first pulsar discovered, CP 1919, superimposed vertically from Radio Observations of the Pulse Profiles and Dispersion Measures of Twelve Pulsars (Craft, 1970).\n\nI'm not going to go into much more here as [Scientific American has already done such a good job.](https://www.scientificamerican.com/blog/sa-visual/pop-culture-pulsar-origin-story-of-joy-division-s-unknown-pleasures-album-cover-video/)\n\nThanks to Scientific American, there is a complete explanation of the dataset and its origin and we can plot it here to recreate the album:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(dplyr)\n\n# Read the uploaded CSV\npulsar <- read.csv(\"joydivision.csv\")\n\nlibrary(ggplot2)\nlibrary(ggridges)\n\ncol1 <- \"black\"\ncol2 <- \"white\"\n\nggplot(pulsar, aes(x = x, y = y, height = z, group = y)) +\n  geom_ridgeline(\n    min_height = min(pulsar$z),\n    scale = 0.2,\n    linewidth = 0.5,\n    fill = col1,\n    colour = col2\n  ) +\n  scale_y_reverse() +\n  theme_void() +\n  theme(\n    panel.background = element_rect(fill = col1),\n    plot.background = element_rect(fill = col1, color = col1),\n  )\n```\n\n::: {.cell-output-display}\n![](morebirdnetstats_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nSo having recreated that one - lets see what we can do with my birdnet data...\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- (Optional) Top 20 species ---\ntop_species <- detections %>%\n  count(Com_Name, sort = TRUE) %>%\n  slice_head(n = 70) %>%    # now only 20 species\n  pull(Com_Name)\n\ndetections_filtered <- detections %>%\n  filter(Com_Name %in% top_species)\n\n# üõ†Ô∏è Calculate overall average confidence per species\nspecies_confidence <- detections_filtered %>%\n  group_by(Com_Name) %>%\n  summarise(AvgConfidence = mean(Confidence, na.rm = TRUE), .groups = \"drop\")\n\n# Join back into main data\ndetections_final <- detections_filtered %>%\n  left_join(species_confidence, by = \"Com_Name\")\n\n# --- JOY DIVISION STYLE RIDGELINE PLOT ---\nggplot(detections_final, aes(x = Hour, y = fct_rev(factor(Com_Name)), group = Com_Name)) +\n  geom_density_ridges(\n    fill = \"black\",\n    color = \"white\",\n    scale = 5,\n    size = 0.1,\n    rel_min_height = 0\n  ) +\n  theme_void() +\n  theme(\n    plot.background = element_rect(fill = \"black\", color = NA),\n    panel.background = element_rect(fill = \"black\", color = NA),\n    axis.text = element_blank(),\n    axis.title = element_blank(),\n    plot.margin = margin(20, 20, 20, 20)\n  )\n```\n\n::: {.cell-output-display}\n![](morebirdnetstats_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nNot far off! \n\n\n",
    "supporting": [
      "morebirdnetstats_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}